(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7791],{1078:(e,t,n)=>{"use strict";n.d(t,{default:()=>i});var r=n(5155),s=n(5695),l=n(8464),a=n(2596);function i(e){let{to:t,hidden:n,className:i,onClick:o,smartNavigation:c=!1,...d}=e,u=(0,s.useRouter)(),h=(0,s.usePathname)();return n?null:(0,r.jsx)("button",{type:"button",onClick:()=>{o?o():t?u.push(t):c&&(document.referrer.includes("/favorites")||h.startsWith("/pet/"))?u.push("/favorites?refresh="+Date.now()):u.back()},className:(0,a.A)("text-[#ed9426] hover:text-orange-300 hover:scale-110 font-bold",i),...d,children:(0,r.jsx)(l.A,{fontSize:"large"})})}},3604:(e,t,n)=>{"use strict";n.d(t,{default:()=>M});var r=n(5155),s=n(4581),l=n(700),a=n(2302),i=n(4507),o=n(8534),c=n(1218),d=n(2110),u=n(6438),h=n(3939),x=n(857),f=n(8890),p=n(9505),m=n(2115),j=n(5695),g=n(7601),A=n(8720);function y(e){return"string"==typeof e?e:e.id}function b(e){let{items:t,selected:n,onChange:s,render:l,getId:a=y}=e,i=e=>{s(n.includes(e)?n.filter(t=>t!==e):[...n,e])};return(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:t.map(e=>{let t=a(e),s=n.includes(t);return(0,r.jsx)("button",{onClick:()=>i(t),className:["rounded-full border px-4 py-1 text-sm transition shadow-sm",s?"bg-orange-500 text-white border-orange-500":"bg-white text-gray-800 border-gray-300 hover:bg-gray-100"].join(" "),children:l(e,s)},t)})})}var v=n(6598),w=n(1078),S=n(6915),k=n(7214),C=n(9008),N=n(785),E=n(6632),P=n(3127);function z(e){let{pet:t,onView:n,onMenuOpen:a}=e,i=[t.breed,t.type,t.ageGroup,t.size].filter(Boolean).join(" • ");return(0,r.jsx)(d.A,{size:{xs:6,sm:6,md:4},children:(0,r.jsxs)(c.A,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[!!t.images.length&&(0,r.jsx)(N.A,{component:"img",image:t.images[0].url,alt:t.name,onClick:()=>n(t.id),sx:{width:"100%",height:{xs:160,md:180},objectFit:"cover",cursor:"pointer",transition:"opacity .25s","&:hover":{opacity:.85}}}),(0,r.jsxs)(E.A,{sx:{flexGrow:1},children:[(0,r.jsxs)(s.default,{display:"flex",justifyContent:"space-between",mb:1,children:[(0,r.jsx)(l.A,{variant:"h6",noWrap:!0,children:t.name}),(0,r.jsx)(P.A,{size:"small",onClick:e=>a(e,t.id),children:(0,r.jsx)(C.A,{})})]}),(0,r.jsx)(l.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:i})]})]})},t.id)}function M(){var e;let t=(0,j.useRouter)(),n=(0,j.useSearchParams)(),{user:y,isLoading:C}=(0,g.A)(),N=Number(null!=(e=n.get("page"))?e:1),E=(0,m.useMemo)(()=>{var e;return(null!=(e=n.get("filters"))?e:"").split(",").filter(Boolean)},[n]),P=(0,m.useCallback)((e,n)=>{let r=new URLSearchParams;e>1&&r.set("page",String(e)),n.length&&r.set("filters",n.join(",")),t.replace("?".concat(r),{scroll:!1})},[t]);(0,m.useEffect)(()=>{!C&&y&&"petOwner"!==y.userType&&t.push("/account")},[y,C,t]);let{pets:M,totalCount:O,isLoading:T,error:_}=function(e,t,n){let[r,s]=(0,m.useState)([]),[l,a]=(0,m.useState)(0),[i,o]=(0,m.useState)(!0),[c,d]=(0,m.useState)(null);return(0,m.useEffect)(()=>{e&&(async()=>{try{o(!0),d(null);let e=new URLSearchParams({page:String(t),limit:String(A.md)});n.length&&e.set("filters",n.join(","));let r=await fetch("/api/pets?".concat(e));if(!r.ok)throw Error("Fetch failed");let{pets:l,totalCount:i}=await r.json();s(l),a(i)}catch(e){console.error(e),d("Failed to load pets")}finally{o(!1)}})()},[e,t,n]),{pets:r,totalCount:l,isLoading:i,error:c}}(null==y?void 0:y.id,N,E),L=(0,m.useCallback)(()=>P(1,E),[P,E]),[W,B]=(0,m.useState)(!1),[D,F]=(0,m.useState)(null),[R,G]=(0,m.useState)(null),[U,I]=(0,m.useState)(null),H=async(e,t)=>{(await fetch(t?"/api/pets/".concat(t):"/api/pets",{method:t?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&L()},J=async e=>{(await fetch("/api/pets/".concat(e),{method:"DELETE"})).ok&&L()},V=Math.max(1,Math.ceil(O/A.md));return C||T?(0,r.jsx)(s.default,{p:3,textAlign:"center",children:(0,r.jsx)(l.A,{children:"Loading…"})}):y&&"petOwner"===y.userType?(0,r.jsxs)(s.default,{sx:{maxWidth:1200,mx:"auto",p:2},children:[(0,r.jsx)(S.default,{left:(0,r.jsx)(w.default,{smartNavigation:!0}),center:(0,r.jsx)(v.A,{title:"My Pet Management",subtitle:"Manage your pets looking for loving homes",centered:!0})}),_&&(0,r.jsx)(a.A,{severity:"error",sx:{mb:3},children:_}),(0,r.jsx)(s.default,{mb:3,children:(0,r.jsx)(b,{items:A.Ao,selected:E,onChange:e=>P(1,e),render:e=>e.label})}),(0,r.jsxs)(s.default,{sx:{display:"flex",alignItems:"center",flexWrap:"nowrap",mb:3,justifyContent:"space-between"},children:[(0,r.jsxs)(l.A,{variant:"h6",sx:{whiteSpace:"nowrap",mr:2},children:[O," ",1===O?"Pet":"Pets"]}),V>1&&(0,r.jsx)(s.default,{sx:{flexGrow:1,display:"flex",justifyContent:"center"},children:(0,r.jsx)(i.A,{count:V,page:N,onChange:(e,t)=>P(t,E),shape:"rounded",size:"small"})}),(0,r.jsx)(o.A,{variant:"contained",startIcon:(0,r.jsx)(x.A,{}),onClick:()=>B(!0),sx:{ml:2,whiteSpace:"nowrap",backgroundColor:"#ed9426","&:hover":{backgroundColor:"#d4841f"}},children:"Add Pet"})]}),0===M.length?(0,r.jsx)(c.A,{sx:{p:6,textAlign:"center"},children:(0,r.jsx)(l.A,{children:"No pets match your filters"})}):(0,r.jsx)(d.A,{container:!0,spacing:2,pb:6,children:M.map(e=>(0,r.jsx)(z,{pet:e,onView:e=>t.push("/pet/".concat(e)),onMenuOpen:(e,t)=>{G(e.currentTarget),I(t)}},e.id))}),(0,r.jsxs)(u.A,{anchorEl:R,open:!!R,onClose:()=>G(null),children:[(0,r.jsxs)(h.A,{onClick:()=>{let e=M.find(e=>e.id===U);if(e){let{id:t,name:n,type:r,breed:s,gender:l,size:a,ageGroup:i,description:o,images:c}=e;F({id:t,name:n,type:r,breed:null!=s?s:"",gender:l,size:a,ageGroup:i,description:null!=o?o:"",imageUrls:c.map(e=>e.url)})}G(null)},children:[(0,r.jsx)(f.A,{sx:{mr:1},fontSize:"small"})," Edit"]}),(0,r.jsxs)(h.A,{onClick:()=>{U&&J(U),G(null)},sx:{color:"error.main"},children:[(0,r.jsx)(p.A,{sx:{mr:1},fontSize:"small"})," Delete"]})]}),(0,r.jsx)(k.A,{open:W||!!D,pet:null!=D?D:void 0,onClose:()=>{B(!1),F(null)},onSubmit:H})]}):(0,r.jsx)(s.default,{p:3,textAlign:"center",children:(0,r.jsx)(l.A,{children:"Access denied."})})}},5561:(e,t,n)=>{Promise.resolve().then(n.bind(n,3604))},6598:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(5155),s=n(4581),l=n(700);function a(e){let{title:t,subtitle:n,centered:a=!0,marginBottom:i=3}=e;return(0,r.jsxs)(s.default,{textAlign:a?"center":"left",mb:i,children:[(0,r.jsx)(l.A,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:t}),n&&(0,r.jsx)(l.A,{variant:"body1",color:"text.secondary",children:n})]})}},6915:(e,t,n)=>{"use strict";n.d(t,{default:()=>s});var r=n(5155);function s(e){let{left:t,center:n,right:s,children:l}=e;return(0,r.jsx)("header",{className:"w-full max-w-md mx-auto  md:max-w-xl py-2 flex items-center justify-between gap-4",children:l||(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:t}),(0,r.jsx)("div",{className:"flex-1 text-center overflow-hidden",children:n}),(0,r.jsx)("div",{className:"flex-shrink-0",children:s})]})})}n(2115)},7601:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(6768),s=n(2115);function l(){let e=(0,r.A)(),[t,n]=(0,s.useState)(null),[l,a]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{if(!(null==e?void 0:e.id))return a(!1);try{let e=await fetch("/api/user/profile");if(e.ok){let t=await e.json();n(t.user)}}catch(e){console.error("Error fetching user data:",e)}finally{a(!1)}})()},[null==e?void 0:e.id]),{user:t,isLoading:l}}}},e=>{var t=t=>e(e.s=t);e.O(0,[6727,5978,8702,9985,3127,8813,9701,4904,8959,5820,2668,4295,8441,1684,7358],()=>t(5561)),_N_E=e.O()}]);